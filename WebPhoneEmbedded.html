<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Ringplan WebPhone</title>
    <link rel="stylesheet" href="css/demo.css" type="text/css"/>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" ></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" type="text/css"/>
    <style>
      .RPclient{
        width: 400px;
        margin-top: 15px;
        margin-bottom: 15px;
        color: lightgrey ;
      }

      .ringplan{
        background-image: url(css/img/RingPlanheader_2_600x.png);
        background-size: cover;
        height: auto;
        width: 600px;
        align-self: left;
      }

      .RPheader{
        background-image: url(./css/img/rpclient-header.png);
        height: 600px;
        background-repeat: no-repeat;
        background-size: contain;

      }

      .RPhspace{
        height: 85px;
      }

      .RPbspace{
        height: 400px;
      }

      .RPinnercontainer{
        width: 360px;
      }

      .RPTitle{
        color: white;
        text-align: center;
        margin-bottom: 25px;
        width: auto;
      }

      .RPlogin{
        height: 350px;
        text-align: center;
        background-color: white;
        padding: 5px;
        vertical-align: text-top;
      }

      .RPloginbuttons{
        height:130px;
        text-align: center;
        vertical-align: center;
      }

      .RPloginbutton{
        height:120px;
        width: 300px;
        text-align: center;

        background-image: url(./css/img/RingPlan\ ZTelco\ cobrand\ 2-01.png);
        background-size: 250px; ;
        background-position: center;
        background-repeat: no-repeat;
        background-color: lightgray;
      }

      .RPmanualbutton{
        height: 120px;
        width: 300px;
        text-align: center;
        vertical-align: center;
        color: black;
        
      }

      .RPclosebutton{
        text-align: right;
        align-self: right;
        width: 300px;
        margin-right: 10px;
      }
    </style>
  </head>

  <body style="background-color: black ;">
    <div class="container RPclient">
      <div class="well RPheader">
        <div class="row">
          <div class="span RPhspace">
          </div> 
          <div class="span">
            <h1 class="RPTitle">RingPlan WebPhone</h1>
          </div>
        </div>
        <div class="row">
          <div id="functions" class="container RPinnercontainer"> 
            <div id="RPLogin" class="well RPlogin" style="">
                <h1>Login</h1>
              <div class="row RPloginbuttons">
                <a class="btn btn-light RPloginbutton" href="javascript: RPmrplogin()"></a>
              </div>
              <div class="row RPloginbuttons">
                <a class="btn btn-primary RPmanualbutton" href="javascript: RPmanuallogin()"><h1>Manual Login</h1></a>
              </div>
            </div>
            <div id="RPloginerror" class="well RPlogin" style="display: none">
            
              <a class="RPclosebutton pull-right" href="javascript: RPLoginHome()"><strong>X</strong></a>
              <h1 style="color:red ;">ERROR</h1>
              <br>
              <h3>Login type not yet supported, please use manual login.</h3>
            </div>
            <div id="RPmanualform" class="well RPlogin" style="display: none">
              <a class="RPclosebutton pull-right" href="javascript: RPLoginHome()"><strong>X</strong></a>
              <h2>Manual Login</h2>
              <div style="text-align: left; color: black;">
                <br>Extension<br>
                <input id='user_id' type='text'>
                <br>Secret<br>
                <input id='user_pwd' type='password'>
                <br>Domain<br>
                <input id='user_domain' type='text' style="width:250px">
                <br>
                <br>
                <a class='btn btn-primary' href="javascript: login()" id='login-btn'>Log in</a>
              </div>
            </div>  
            <div id='my-container' class='container RPinnercontainer'>
              <!--
                Pasting Code for styling
              -->
              <div class="row" id="webphone-icon">
                <div class='col-md-3'>
                  <span id='show-phone' class='text-info' style="display: none">
                    <p>Phone Connected</p>
                    <a class="btn btn-primary" onclick='$("#webphone-keypad").parent().webphone.show()'>Show Dialpad</a>
                  </span>
                  <span id='inactive-phone' class='text-info' title='Webphone service not available'>
                    <div style="color:red"><strong>Phone Not Connected</strong></div>
                  </span>
                </div>
              </div>
        
              <div class="row" id="webphone-incoming-call" style="display: none;">
                <div class="webphone-panel col-md-3">
                  <div class='row' style='margin-top: 20px'>
                    <div>
                      <p class='text-center'>INCOMING CALL</p>
                      <p class='webphone-caller-id text-center'>
                        <i class='fa fa-volume-control-phone'></i>
                        <b></b>
                      </p>
                    </div>
                  </div>
                  <div class='row'>
                    <p class='text-center' style='padding-top: 50px; padding-bottom: 50px'>
                      <img src="./css/img/avatar.jpg"></img>
                    </p>
                  </div>
                  <div class='row'>
                    <div class='webphone-reject-key col-md-offset-1 col-sm-offset-1 col-xs-offset-1 col-md-3 col-sm-3 col-xs-3 text-center'>
                      Reject
                    </div>
                    <div class='webphone-answer-key col-md-offset-4 col-sm-offset-4 col-xs-offset-4 col-md-3 col-sm-3 col-xs-3 text-center'>
                      Answer
                    </div>
                  </div>
                </div>
              </div>
        
              <div class="row" id="webphone-video" style="display: none;">
                <div class="webphone-video-frame webphone-panel col-md-3">
                  <div class="webphone-video-top-overlay row">
                    <div class="col-md-12">
                      <div class="row">
                        <div class="webphone-video-fkey col-md-4 col-lg-4 col-sm-4 col-xs-4"><p>Transfer</p></div>
                        <div class="webphone-video-fkey webphone-video-fkey-center col-md-4 col-lg-4 col-sm-4 col-xs-4"><p>Hold</p></div>
                        <div class="webphone-video-fkey col-md-4 col-lg-4 col-sm-4 col-xs-4"><p>Mute</p></div>
                      </div>
                      <div class="row">
                        <div class="webphone-video-elapse-time webphone-elapse-time col-md-3">
                          00:00
                        </div>
                      </div>
                    </div>
                  </div>
        
                  <div class="webphone-video-main">
                    <video id="remote-side-video" autoplay="true" loop="true"></video>
                  </div>
        
                  <div class="webphone-video-bottom-overlay row">
                    <div class="col-md-5 col-lg-5 col-sm-5 col-xs-5" id='webphone-video-end-btn'>
                      <div class="webphone-video-bottom-overlay-btn">
                        <p>End Call</p>
                      </div>
                    </div>
                    <div class="col-md-4 col-lg-4 col-sm-4 col-xs-4">
                      &nbsp;
                    </div>
                    <div class="webphone-pip-frame col-md-3 col-lg-3 col-sm-3 col-xs-3">
                      <div class="webphone-video-pip">
                        <video class='webphone-horizontal-flip' id="local-side-video" muted="true" loop="true" autoplay="true"></viedo>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
        
              <div class="row" id="webphone-keypad" style="display: none">
                <div class="webphone-panel col-md-3">
                  <div class='row'>
                    <div class="pull-left" style="margin-left: 8px;">
                      <img class="webphone-logo" />
                    </div>
                    <div class="pull-right" style="margin-right: 8px">
                      <a href="javascript: $('#webphone-keypad').parent().webphone.hide()">x</a>
                    </div>
                  </div>
                  <div class='webphone-display row'>
                    <div class="webphone-digits col-md-12" style="min-height: 57px">
                    </div>
                  </div>
                  <div class='webphone-display row'>
                    <div id="last-call" class="pull-left" style="padding-left: 15px; min-height: 22px">
                      &nbsp;
                    </div>
                    <div id="elapse-time" class="pull-left webphone-elapse-time" style="display: none; padding-left: 15px; min-height: 22px">
                    </div>
                  </div>
                  <div class='row' id="no-call">
                    <div class="webphone-fkey side-key col-md-4 col-sm-4 col-xs-4" id="webphone-redial-btn">
                      <p><i class="fa fa-repeat"></i></p>
                    </div>
                    <div class="webphone-fkey center-key col-md-4 col-sm-4 col-xs-4">
                      <p>&nbsp;</p>
                    </div>
                    <div class="webphone-fkey side-key col-md-4 col-sm-4 col-xs-4" id="webphone-backspace-btn">
                      <p><i class='fa fa-step-backward'></i></p>
                    </div>
                  </div>
                  <div class='row webphone-inactive' id="in-call">
                    <div class="webphone-fkey side-key col-md-4 col-sm-4 col-xs-4" id="webphone-xfer-btn">
                      <p>Transfer</p>
                    </div>
                    <div class="webphone-fkey center-key col-md-4 col-sm-4 col-xs-4" id="webphone-hold-btn">
                      <p id="hold-btn-text">Hold</p>
                      <p id="resume-btn-text" class="webphone-inactive">Resume</p>
                    </div>
                    <div class="webphone-fkey side-key col-md-4 col-sm-4 col-xs-4" id="webphone-mute-btn">
                      <p id="mute-btn-text">Mute</p>
                      <p id="unmute-btn-text" class="webphone-inactive">Unmute</p>
                    </div>
                  </div>
                  <div class='row'>
                    <div class="webphone-key side-key col-md-4 col-sm-4 col-xs-4" id="webphone-1-btn">
                      <p>1</p>
                    </div>
                    <div class="webphone-key center-key col-md-4 col-sm-4 col-xs-4" id="webphone-2-btn">
                      <p>2<small>ABC</small></p>
                    </div>
                    <div class="webphone-key side-key col-md-4 col-sm-4 col-xs-4" id="webphone-3-btn">
                      <p>3<small>DEF</small></p>
                    </div>
                  </div>
                  <div class='row'>
                    <div class="webphone-key side-key col-md-4 col-sm-4 col-xs-4" id="webphone-4-btn">
                      <p>4<small>GHI</small></p>
                    </div>
                    <div class="webphone-key center-key col-md-4 col-sm-4 col-xs-4" id="webphone-5-btn">
                      <p>5<small>KJL</small></p>
                    </div>
                    <div class="webphone-key side-key col-md-4 col-sm-4 col-xs-4" id="webphone-6-btn">
                      <p>6<small>MNO</small></p>
                    </div>
                  </div>
                  <div class='row'>
                    <div class="webphone-key side-key col-md-4 col-sm-4 col-xs-4" id="webphone-7-btn">
                      <p>7<small>PQRS</small></p>
                    </div>
                    <div class="webphone-key center-key col-md-4 col-sm-4 col-xs-4" id="webphone-8-btn">
                      <p>8<small>TUV</small></p>
                    </div>
                    <div class="webphone-key side-key col-md-4 col-sm-4 col-xs-4" id="webphone-9-btn">
                      <p>9<small>WXYZ</small></p>
                    </div>
                  </div>
                  <div class='row'>
                    <div class="webphone-key side-key col-md-4 col-sm-4 col-xs-4" id="webphone-star-btn">
                      <p><i class="fa fa-asterisk"></i></p>
                    </div>
                    <div class="webphone-key center-key col-md-4 col-sm-4 col-xs-4" id="webphone-0-btn">
                      <p>0</p>
                    </div>
                    <div class="webphone-key side-key col-md-4 col-sm-4 col-xs-4" id="webphone-pound-btn">
                      <p><i class="fa fa-hashtag"></i></p>
                    </div>
                  </div>
                  <div class='row'>
                    <div class="webphone-ckey-voice col-md-8 col-sm-8 col-xs-8" id="webphone-call-btn">
                      <p id="call-btn-text" class="text-center">Call</p>
                      <p id="end-call-btn-text" class="text-center webphone-inactive">End Call</p>
                    </div>
                    <div class="webphone-ckey-video col-md-4 col-sm-4 col-xs-4" id="webphone-video-btn">
                      <p><i class="fa fa-video-camera"></i></p>
                    </div>
                  </div>
                </div>
              </div>
              <!--
                end of non-functioning code
              -->
            </div>
            <a class='btn btn-warning' href='javascript: logout()' id='logout-btn' style='display: none'>Log out</a>
          </div>
        </div>
      </div>
      <h3>DEV Buttons</h3>
      <a class='btn btn-warning' href='javascript: logout()'>Log out</a>
      <a class='btn btn-primary' href='javascript: RPdevhideall()'>hide all elements</a>
      <a class='btn btn-primary' href='javascript: RPdevconnect()'>connect WebSBC</a>
    </div>
    <script src='./websbc-client.js'></script>
    <script src='./webphone-plugin.js'></script>
    <script>
        window.onload = function() {
	        // Set the prefilled domain here
	        $('#user_domain').val('zraytechnoloDoobh.ringplan.com')
          // set the websocket servr address here
          $('#my-container').webphone(["sip.ringplan.com"]);

          var uname, pass, cname, domain;
          console.log(uname = getCookie("user_id"));
          console.log(pass = getCookie("secret"));
          console.log(cname = getCookie("cname"));
          console.log(domain = getCookie("domain"));

          if (window.location.search.length > 1
				  && window.location.search.toLowerCase().indexOf('user=') > -1
				  && window.location.search.toLowerCase().indexOf('pass=') > -1) {
            var query_params = window.location.search.split('&')
			      for (var i = 0; i < query_params.length; i++) {
			        if (query_params[i].toLowerCase().indexOf('user=') > -1) {
				        uname = query_params[i].split('=')[1];
			           }
			         else if (query_params[i].toLowerCase().indexOf('pass=') > -1) {
				        pass = query_params[i].split('=')[1];
			          }
			        else if (query_params[i].toLowerCase().indexOf('cname=') > -1) {
				        cname = query_params[i].split('=')[1].replace('%20', ' ');
			          }
			        else if (query_params[i].toLowerCase().indexOf('domain=') > -1) {
				        domain = query_params[i].split('=')[1];
			          }
			        }
		        }
		      if (uname.length > 1 && pass.length > 1){
		        $('#user_id').val(uname);
		        $('#user_pwd').val(pass);
		        $('#user_cname').val(cname);
		        $('#user_domain').val(domain);
		        //disabled autologin
            //setTimeout(login(), 500);
		        }
          };

        function login() {
          var user = $('#user_id').val();
          var pwd = $('#user_pwd').val();
          var cname = $('#user_cname').val();
          var domain = $('#user_domain').val();
          if (domain.length > 0)
            $('#my-container').webphone.login(user, pwd, cname, domain, function() {
              $('#logout-btn').show();
              $('#RPmanualform').hide();
            },
            function() {
              $('#logout-btn').hide();
              //alert("Disconnected from server");
              $('#RPLogin').show();
            });
          else
            $('#my-container').webphone.login(user, pwd, cname);
            
        }

        function logout() {
          $('#my-container').webphone.logout();
          $('#logout-btn').hide();
          $('#RPmanualform').show();
        }

        // dev test functions

        function devlogin() {
          $('#login-btn').hide();
          $('#logout-btn').show();
          $('#login-msg').hide();
          $('#reginfo').hide();
        }

        function devlogout() {
          $('#logout-btn').hide();
          $('#login-btn').show();
          $('#reginfo').show();
        }

        function RPmrplogin() {
          $('#RPLogin').hide();
          $('#RPloginerror').show();
        }

        function RPLoginHome() {
          $('#RPloginerror').hide();
          $('#RPmanualform').hide();
          $('#RPLogin').show();
        }
        
        function RPmanuallogin() {
          $('#RPLogin').hide();
          $('#RPmanualform').show();
        }

        function RPdevhideall() {
          $('#RPLogin').hide();
          $('#RPmanualform').hide();
          $('#RPlogincontrol').show();
          $('#RPloginerror').hide();
          $('#show-phone').hide();
          $('#inactive-phone').hide();
          $('#webphone-incoming-call').hide();
          $('#webphone-video').hide();
          $('#webphone-video-main').hide();
          $('#webphone-video-bottom-overlay').hide();
          $('#webphone-keypad').hide();
        }

        function RPdevconnect(){
          $('#show-phone').show();
          $('#inactive-phone').hide();
        }


    </script>
  </body>
</html>
